 # KoAP_RF

Бот отвечает на вопросы по документу "Кодекс Российской Федерации об административных правонарушениях" от 30.12.2001 N 195-ФЗ (ред. от 08.08.2024) (с изм. и доп., вступ. в силу с 08.09.2024).

## Установка

Установить зависимости из файла `requirements.txt`:

```bash
pip install -r requirements.txt
```
Заполнить учетные данные [GigaChat](https://developers.sber.ru/portal/products/gigachat-api#tariffs) в `config/secrets.sample.yaml`, и переименовать в `config/secrets.yaml`

 ## Использование

### 1. Создание базы

Создать базу данных и загрузка документа в коллекцию ChromaDB:

```bash
python ingest.py
```

### 2. Запуск консультанта

Запустить сервис FastAPI:

```bash
fastapi dev main.py
```

### 3. Демо
Бот доступен по ссылке: [158.160.4.178:8000/docs](158.160.4.178:8000/docs) 

Пример запроса
```json
{
  "query": "Какой штраф предусмотрен для должностных лиц за повторную продажу товаров ненадлежащего качества?",
  "show_sources": true
}
```
Пример ответа
```json
{
  "answer": "Повторная продажа товаров ненадлежащего качества должностным лицом влечет наложение административного штрафа на должностных лиц в размере от семи тысяч до пятнадцати тысяч рублей либо дисквалификацию на срок до одного года.",
  "norm": "Статья 14.4.",
  "source_document": "Продажа товаров, выполнение работ либо оказание населению услуг ненадлежащего качества или с нарушением установленных законодательством Российской Федерации требований\n(в ред. Федерального закона от 18.07.2011 N 237-ФЗ)\n1. Продажа товаров, не соответствующих образцам по качеству, выполнение работ либо оказание населению услуг, не соответствующих требованиям нормативных правовых актов, устанавливающих порядок (правила) выполнения работ либо оказания населению услуг, за исключением случаев, предусмотренных статьями 14.4.2 и 14.4.3 настоящего Кодекса, -\n(в ред. Федеральных законов от 25.11.2013 N 317-ФЗ, от 27.12.2019 N 493-ФЗ)\nвлечет наложение административного штрафа на граждан в размере от одной тысячи до двух тысяч рублей; на должностных лиц - от трех тысяч до десяти тысяч рублей; на лиц, осуществляющих предпринимательскую деятельность без образования юридического лица, - от десяти тысяч до двадцати тысяч рублей; на юридических лиц - от двадцати тысяч до тридцати тысяч рублей.\n2. Повторное совершение административного правонарушения, предусмотренного частью 1 настоящей статьи, -\n(в ред. Федерального закона от 23.07.2013 N 196-ФЗ)\nвлечет наложение административного штрафа на граждан в размере от двух тысяч до пяти тысяч рублей; на должностных лиц - от семи тысяч до пятнадцати тысяч рублей либо дисквалификацию на срок до одного года; на лиц, осуществляющих предпринимательскую деятельность без образования юридического лица, - от пятнадцати тысяч до тридцати тысяч рублей с конфискацией предметов административного правонарушения либо без таковой; на юридических лиц - от тридцати тысяч до пятидесяти тысяч рублей с конфискацией предметов административного правонарушения либо без таковой."
}
```


### 4. Примеры ответов на другие вопросы
Результаты RAG можно найти в `./chat_history`